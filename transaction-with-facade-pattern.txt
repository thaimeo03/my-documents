1Ô∏è‚É£ Facade Service l√† g√¨? (hi·ªÉu ƒë√∫ng b·∫£n ch·∫•t)

Facade Service l√† l·ªõp ƒëi·ªÅu ph·ªëi (orchestrator):

KH√îNG ch·ª©a logic DB n·∫∑ng

KH√îNG x·ª≠ l√Ω transaction chi ti·∫øt

Ch·ªâ:

validate

g·ªçi nhi·ªÅu service con

ƒëi·ªÅu ph·ªëi flow nghi·ªáp v·ª•

üëâ Transaction th·∫≠t s·ª± n·∫±m ·ªü service con, kh√¥ng n·∫±m ·ªü facade.

2Ô∏è‚É£ Khi n√†o n√™n d√πng Facade Service?

D√πng khi:

1 use-case g·ªçi nhi·ªÅu service

C√≥ nhi·ªÅu b∆∞·ªõc nghi·ªáp v·ª•

Mu·ªën:

tr√°nh self-invocation

ki·ªÉm so√°t transaction r√µ r√†ng

d·ªÖ rollback theo t·ª´ng b∆∞·ªõc

üí° R·∫•t ph·ªï bi·∫øn trong:

Import / Batch

Workflow nhi·ªÅu b∆∞·ªõc

Banking / Payment / Order

3Ô∏è‚É£ C·∫•u tr√∫c chu·∫©n (th·ª±c t·∫ø ƒëi l√†m)
Controller
   |
   v
Facade Service  (NO @Transactional)
   |
   +--> Tx Service A (@Transactional)
   |
   +--> Tx Service B (@Transactional)

4Ô∏è‚É£ V√≠ d·ª• c·ª• th·ªÉ (chu·∫©n production)
4.1 Controller
@RestController
@RequestMapping("/orders")
public class OrderController {

    private final OrderFacade orderFacade;

    public OrderController(OrderFacade orderFacade) {
        this.orderFacade = orderFacade;
    }

    @PostMapping
    public void createOrder() {
        orderFacade.createOrder();
    }
}

4.2 Facade Service (KH√îNG transaction)
@Service
public class OrderFacade {

    private final OrderTxService orderTxService;
    private final InventoryTxService inventoryTxService;

    public OrderFacade(
        OrderTxService orderTxService,
        InventoryTxService inventoryTxService
    ) {
        this.orderTxService = orderTxService;
        this.inventoryTxService = inventoryTxService;
    }

    public void createOrder() {
        // orchestration only
        orderTxService.createOrder();
        inventoryTxService.reserveStock();
    }
}


‚úî Kh√¥ng @Transactional
‚úî Ch·ªâ ƒëi·ªÅu ph·ªëi
‚úî Kh√¥ng DB logic

4.3 Transactional Services
@Service
public class OrderTxService {

    @Transactional
    public void createOrder() {
        // insert order
    }
}

@Service
public class InventoryTxService {

    @Transactional
    public void reserveStock() {
        // update stock
    }
}


‚úî Transaction ƒë∆∞·ª£c m·ªü ƒë√∫ng ch·ªó
‚úî Kh√¥ng self-invocation
‚úî D·ªÖ test
